---
layout: post
title: "columnar memory layout"
등록일: 2023-04-18
수정일: 2023-04-
author: 이한솔
---


## **목차**
1. parquet, arrow


---

parquet 인코딩
hybrid

---

## **행 지향 저장 방식 vs 열 지향 저장 방식**
1. 행 지향 저장 방식 : 행(row) 단위로 데이터를 쭉 이어서 저장하는 방식.    
    - RDB    
2. 열 지향 저장 방식 : 열(column) 단위로 데이터를 저장하는 방식. 컬럼 단위의 집계에 최적화.    
   - 열 지향 storage : Apache Cassandra, Apache HBase    
     열 지향 데이터 저장 format : Apache parquet, Apache orc    
   - **장점**
        - 디스크 I/O를 줄일 수 있음    
        : 필요한 컬럼만을 로드함. 행 지향은 행 단위로 저장되어 있어서 필요 없는 열까지 디스크로부터 로드.    
        ![image](https://user-images.githubusercontent.com/109563345/233277650-c7369dea-5406-4b42-ba55-908898b9f77d.png)
        - 데이터 압축 효율 우수    
        : 같은 컬럼에는 대부분 유사하거나 중복된 데이터가 나열됨     
            → 중복된 데이터를 압축해서 저장 가능. 특히 같은 문자열의 반복은 매우 작게 압축이 가능    

                ex) 데이터 압축 방법 (허프만 코딩)        
                : 데이터 문자가 얼마나 자주 출현하는지 빈도를 파악해 빈도수가 높은 기호에 짧은 접두어 코드를 부여     
                
                문자열 "aabbaabcd"    
                a(5번), b(3번), c(1번)와 d(1번) 이 순서대로 짧은 코드를 부여합니다. a=0, b=01, c=011, d=111    
                → 00001010001011111 으로 압축    
                압축 전의 문자열은 80비트 ⇒ 17비트로 21% 압축    
            
### **압축 방법**
1. Gzip
    - 비교적 느린 속도
    - 상대적으로 높은 cpu 사용률
    - 압축률이 높아 상대적으로 적은 용량 차지    
    → 사용 빈도가 낮거나 장기적 보존이 필요한 경우 적합해보임    
2. Snappy
    - 빠른 압축, 해제 속도
    - 상대적으로 낮은 cpu 사용률
    - 압축률이 낮아 상대적으로 많은 용량 차지    
    → 빈번하게 액세스되는 데이터 사용시 적합해보임. ex) 실시간 데이터 처리    
3. Zstd
    - Gzip과 비슷한 압축률이지만 속도가 빠름
    - 성능 비교가 필요한 것으로 보임

--- 

출처    
허프만 코딩 <https://nykim.work/93>    
압축 비교 <https://www.youtube.com/watch?v=EQhldyLWPwI>
